# Improving critical exponent estimations with Generative Adversarial Networks

## Requirements

* Python 3.8+
* wheel
* cython
* Tensorflow
* sklearn
* scipy==1.5.4
* tqdm
* jupyter
* pandas

```shell
pip install .
OR
python setup.py install

```
## Generate and save configurations.

```shell
    python src/statphy/data_factory.py      \
        --model square_lattice_percolation  \
        --L 32 128                          \
        --control_parameter 0.52 0.6        \
        --samples 100                       \
        --path "."
```

## Control parameter estimation via CNN

[CNN](https://drive.google.com/file/d/1672V_ZPCHSVUohgRHw1nHLROkyo8_rJI/view?usp=sharing)

 ```shell
    python src/CNN_percolation/main.py  \
       --odir "saved_models"        \
       --L 128                      \
       --p_down 0.5                 \
       --p_up 0.7                   \
       --p_increment 0.02           \
       --round_digit 2              \
       --epochs 100                 \
       --n_configs_per_p 1000       \
       --patience 10                \
       --test_size 0.2              \
       --batch_size 32              \
       --random_state 42            \
       --dropout_rate 0          
 ```

## Data augmentation via GAN

### Train GAN

Make sure that configurations have been created first (at "/data/0.5928" in the following example).

```shell
    python src/GAN/train.py \
        --data_dir /data/0.5928 \
        --batch_size 32 \
        --epochs 200 \
        --noise_dim 100 \
        --save_dir /saved-files
``` 

### Generate configurations with GAN

```shell
    python src/GAN/generate.py \
        --num 10 \
        --data_dir ./data/generated/
        --model_dir ./data/models/gan/ \
        --noise_dim 100
```

### Verify the control parameter of the GAN-generated configurations

Make sure that synthetic data has been generated by the GAN in 'data/generated/' as .npy files, one file per configuration.

```shell
    python src/benchmark/benchmark.py
```

## License
[Apache License 2.0](https://github.com/bisonai/mobilenetv3-tensorflow/blob/master/LICENSE)
